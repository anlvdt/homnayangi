<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hôm Nay Ăn Gì?</title>
  <link rel="icon" href="icons/icon-192.png" type="image/png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1a6b3a">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container">
    <header>
      <img src="icons/icon-192.png" alt="Logo" class="header-logo">
      <h1>Hôm Nay Ăn Gì?</h1>
      <p>Chọn một lá bài để xem món ăn của bạn</p>
    </header>

    <div class="controls">
      <button class="btn mode-btn active" id="singleMode">Một người</button>
      <button class="btn mode-btn" id="multiMode">Nhiều người</button>
      <select class="filter-select" id="categoryFilter">
        <option value="all">Tất cả</option>
        <option value="♥">Bún/Phở</option>
        <option value="♦">Cơm</option>
        <option value="♣">Bánh/Xôi</option>
        <option value="♠">Món khác</option>
      </select>
      <select class="filter-select" id="regionFilter">
        <option value="all">Cả nước</option>
        <option value="B">Miền Bắc</option>
        <option value="T">Miền Trung</option>
        <option value="N">Miền Nam</option>
      </select>
      <select class="filter-select filter-fav" id="favFilter">
        <option value="all">Tất cả món</option>
        <option value="fav">Yêu thích</option>
      </select>
      <button class="btn icon-btn" id="resetBtn" title="Chia lại bộ bài">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
          <path d="M3 3v5h5" />
        </svg>
      </button>
      <button class="btn icon-btn" id="settingsBtn" title="Cài đặt">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3" />
          <path
            d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" />
        </svg>
      </button>
    </div>

    <div class="player-bar" id="playerBar">
      <div class="current-player">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
          <circle cx="12" cy="7" r="4" />
        </svg>
        <span id="playerName">Người chơi 1</span>
      </div>
      <div class="game-info">
        <span class="cards-left"><strong id="remaining">52</strong> lá</span>
        <button class="btn icon-btn-sm" id="resultsToggle" title="Xem kết quả">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
          </svg>
        </button>
        <button class="btn icon-btn-sm end-game-btn" id="endGameBtn" title="Kết thúc">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <line x1="9" y1="9" x2="15" y2="15" />
            <line x1="15" y1="9" x2="9" y2="15" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Multiplayer Setup Modal -->
    <div class="multiplayer-modal" id="multiplayerModal">
      <div class="multiplayer-bg" id="multiplayerBg"></div>
      <div class="multiplayer-content">
        <div class="modal-header">
          <h2>Chơi nhiều người</h2>
          <button class="close-x" id="closeMultiplayerX">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <div class="player-count-selector">
          <span class="count-label">Số người chơi</span>
          <div class="count-buttons">
            <button class="count-btn" data-count="2">2</button>
            <button class="count-btn active" data-count="3">3</button>
            <button class="count-btn" data-count="4">4</button>
            <button class="count-btn" data-count="5">5</button>
            <button class="count-btn" data-count="6">6</button>
          </div>
        </div>

        <div class="player-inputs" id="playerInputs">
          <!-- Generated by JS -->
        </div>

        <button class="btn start-game-btn" id="startGameBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="5 3 19 12 5 21 5 3" />
          </svg>
          Bắt đầu chơi
        </button>
      </div>
    </div>

    <div class="results-panel" id="resultsPanel">
      <div class="results-panel-bg" id="resultsPanelBg"></div>
      <div class="results-panel-content">
        <div class="results-header">
          <h3>Kết quả</h3>
          <button class="close-x" id="closeResultsPanel">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="results-list" id="resultsList"></div>
      </div>
    </div>

    <div class="deck" id="deck"></div>

    <div class="modal" id="modal">
      <div class="modal-bg" id="modalBg"></div>
      <div class="modal-card">
        <div class="result-card" id="resultCard"></div>
        <div class="modal-buttons">
          <button class="btn close-btn" id="closeBtn">Đóng</button>
          <button class="btn next-btn" id="nextBtn">Người tiếp theo</button>
          <button class="btn share-btn" id="shareBtn">Chia sẻ</button>
        </div>
      </div>
    </div>

    <!-- Settings Modal - Now includes all features -->
    <div class="settings-modal" id="settingsModal">
      <div class="settings-bg" id="settingsBg"></div>
      <div class="settings-content">
        <div class="settings-header">
          <h2>Cài đặt</h2>
          <button class="close-x" id="closeSettingsX">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- Settings Tabs -->
        <div class="settings-nav">
          <button class="nav-btn active" data-section="general">Chung</button>
          <button class="nav-btn" data-section="features">Tính năng</button>
          <button class="nav-btn" data-section="history">Lịch sử</button>
          <button class="nav-btn" data-section="about">Giới thiệu</button>
        </div>

        <!-- General Settings -->
        <div class="settings-section active" id="sectionGeneral">
          <div class="setting-item">
            <div class="setting-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
              </svg>
              <span>Chế độ tối</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="darkModeToggle">
              <span class="slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07" />
              </svg>
              <span>Âm thanh</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="soundToggle" checked>
              <span class="slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <polyline points="12 6 12 12 16 14" />
              </svg>
              <span>Gợi ý theo giờ</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="timeFilterToggle" checked>
              <span class="slider"></span>
            </label>
          </div>

          <div class="setting-item">
            <div class="setting-label">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
              </svg>
              <span>Tốc độ animation</span>
            </div>
            <select id="animSpeedSelect">
              <option value="slow">Chậm</option>
              <option value="normal" selected>Bình thường</option>
              <option value="fast">Nhanh</option>
            </select>
          </div>
        </div>

        <!-- Features Section -->
        <div class="settings-section" id="sectionFeatures">
          <div class="feature-card" id="openPlannerBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            <div class="feature-info">
              <span class="feature-title">Lịch ăn tuần</span>
              <span class="feature-desc">Lên kế hoạch món ăn cho cả tuần</span>
            </div>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </div>

          <div class="feature-card" id="openCustomDishBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10" />
              <line x1="12" y1="8" x2="12" y2="16" />
              <line x1="8" y1="12" x2="16" y2="12" />
            </svg>
            <div class="feature-info">
              <span class="feature-title">Thêm món mới</span>
              <span class="feature-desc">Tạo món ăn tùy chỉnh của bạn</span>
            </div>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </div>

          <div class="feature-card" id="openExcludesBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10" />
              <line x1="4.93" y1="4.93" x2="19.07" y2="19.07" />
            </svg>
            <div class="feature-info">
              <span class="feature-title">Món không thích</span>
              <span class="feature-desc">Loại trừ món bạn không muốn ăn</span>
            </div>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6" />
            </svg>
          </div>
        </div>

        <!-- History Section -->
        <div class="settings-section" id="sectionHistory">
          <div class="history-tabs">
            <button class="tab-btn active" data-tab="history">Lịch sử</button>
            <button class="tab-btn" data-tab="stats">Thống kê</button>
          </div>

          <div class="tab-content" id="historyTab">
            <div id="historyList"></div>
          </div>

          <div class="tab-content hidden" id="statsTab">
            <div id="statsContent"></div>
          </div>
        </div>

        <!-- About Section -->
        <div class="settings-section" id="sectionAbout">
          <div class="about-header">
            <img src="icons/icon-192.png" alt="App Icon" class="about-logo">
            <div class="about-title">
              <h3>Hôm Nay Ăn Gì?</h3>
              <span class="about-version">v1.0</span>
            </div>
          </div>

          <p class="about-desc">Ứng dụng giúp bạn chọn món ăn mỗi ngày một cách thú vị với bộ bài 52 lá. Hỗ trợ chơi
            nhiều người, lên lịch ăn tuần, và thêm món tùy chỉnh.</p>

          <div class="about-divider"></div>

          <div class="about-author">
            <span class="author-label">Tác giả</span>
            <span class="author-name">Le An</span>
            <a href="https://github.com/anlvdt" target="_blank" class="author-github">
              <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                <path
                  d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z" />
              </svg>
              @anlvdt
            </a>
          </div>

          <div class="about-divider"></div>

          <div class="about-donate">
            <span class="donate-title">Ủng hộ tác giả</span>
            <p class="donate-desc">Nếu thấy hữu ích, mời bạn một ly cà phê nhé!</p>

            <div class="donate-card">
              <div class="donate-row">
                <span class="bank-name">MB Bank</span>
                <span class="bank-number">0360126996868</span>
              </div>
              <div class="donate-row">
                <span class="bank-name momo">Momo</span>
                <span class="bank-number">0976896621</span>
              </div>
              <span class="donate-holder">LE VAN AN</span>
            </div>

            <a href="https://collshp.com/laptopleandotcom?view=storefront" target="_blank" class="shopee-link">
              <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                <path
                  d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
              </svg>
              Ghé thăm Shopee
            </a>
          </div>

          <p class="about-footer">© 2026 Le An · MIT License</p>
        </div>
      </div>
    </div>

    <!-- Planner Modal -->
    <div class="planner-modal" id="plannerModal">
      <div class="planner-bg" id="plannerBg"></div>
      <div class="planner-content">
        <div class="modal-header">
          <h2>Lịch Ăn Tuần</h2>
          <button class="close-x" id="closePlannerX">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="week-grid" id="weekGrid"></div>
        <div class="planner-actions">
          <button class="btn auto-fill-btn" id="autoFillBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="2" width="20" height="20" rx="5" />
              <circle cx="8.5" cy="8.5" r="1.5" />
              <circle cx="15.5" cy="8.5" r="1.5" />
              <circle cx="15.5" cy="15.5" r="1.5" />
              <circle cx="8.5" cy="15.5" r="1.5" />
            </svg>
            Tự động
          </button>
          <button class="btn clear-plan-btn" id="clearPlanBtn">Xóa tất cả</button>
        </div>
      </div>
    </div>

    <!-- Custom Dish Modal -->
    <div class="custom-dish-modal" id="customDishModal">
      <div class="custom-dish-bg" id="customDishBg"></div>
      <div class="custom-dish-content">
        <div class="modal-header">
          <h2>Thêm món mới</h2>
          <button class="close-x" id="closeCustomDishX">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>

        <div class="form-group">
          <label>Tên món</label>
          <input type="text" id="customDishName" placeholder="VD: Bún riêu cua">
        </div>

        <div class="form-group">
          <label>Ăn kèm</label>
          <input type="text" id="customDishPairing" placeholder="VD: Rau sống, đậu phụ">
        </div>

        <div class="form-group">
          <label>Loại</label>
          <select id="customDishCategory">
            <option value="♥">Bún/Phở</option>
            <option value="♦">Cơm</option>
            <option value="♣">Bánh/Xôi</option>
            <option value="♠">Món khác</option>
          </select>
        </div>

        <div class="form-group">
          <label>Hình ảnh (URL)</label>
          <input type="text" id="customDishImage" placeholder="https://...">
        </div>

        <div class="custom-dish-buttons">
          <button class="btn" id="cancelCustomDish">Hủy</button>
          <button class="btn save-dish-btn" id="saveCustomDish">Lưu món</button>
        </div>

        <div class="custom-dishes-list" id="customDishesList">
          <h3>Món đã thêm</h3>
          <div id="customDishesContent"></div>
        </div>
      </div>
    </div>

    <!-- Excludes Modal -->
    <div class="excludes-modal" id="excludesModal">
      <div class="excludes-bg" id="excludesBg"></div>
      <div class="excludes-content">
        <div class="modal-header">
          <h2>Món không thích</h2>
          <button class="close-x" id="closeExcludesX">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <p class="excludes-desc">Chọn món bạn không muốn xuất hiện khi bốc bài</p>
        <div class="excludes-list" id="excludesList"></div>
      </div>
    </div>
  </div>

  <!-- Onboarding Modal -->
  <div class="onboarding-modal" id="onboardingModal">
    <div class="onboarding-content">
      <div class="onboarding-slide active" data-slide="1">
        <div class="onboarding-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="2" y="2" width="20" height="20" rx="3" />
            <path d="M12 8v8M8 12h8" />
          </svg>
        </div>
        <h2>Chào mừng đến với<br>Hôm Nay Ăn Gì?</h2>
        <p>Ứng dụng giúp bạn chọn món ăn mỗi ngày một cách thú vị với bộ bài 52 lá!</p>
      </div>

      <div class="onboarding-slide" data-slide="2">
        <div class="onboarding-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="7" height="10" rx="1" />
            <path d="M14 5h4M14 9h4M14 13h2" />
          </svg>
        </div>
        <h2>Bốc bài ngẫu nhiên</h2>
        <p>Chạm vào bất kỳ lá bài nào để xem món ăn may mắn của bạn hôm nay!</p>
      </div>

      <div class="onboarding-slide" data-slide="3">
        <div class="onboarding-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="12" cy="10" r="3" />
            <path d="M12 2a8 8 0 0 0-8 8c0 5.4 7 11 8 12 1-1 8-6.6 8-12a8 8 0 0 0-8-8z" />
          </svg>
        </div>
        <h2>Lọc theo vùng miền</h2>
        <p>Chọn món ăn theo vùng miền Bắc, Trung, Nam phù hợp với khẩu vị của bạn!</p>
      </div>

      <div class="onboarding-slide" data-slide="4">
        <div class="onboarding-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path
              d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
          </svg>
        </div>
        <h2>Yêu thích & Loại trừ</h2>
        <p>Đánh dấu món yêu thích và loại bỏ món không thích để bốc bài theo ý muốn!</p>
      </div>

      <div class="onboarding-slide" data-slide="5">
        <div class="onboarding-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" />
          </svg>
        </div>
        <h2>Chơi cùng bạn bè</h2>
        <p>Chế độ nhiều người cho phép cả nhóm cùng bốc bài và xem ai được món ngon nhất!</p>
      </div>

      <div class="onboarding-dots">
        <span class="dot active" data-dot="1"></span>
        <span class="dot" data-dot="2"></span>
        <span class="dot" data-dot="3"></span>
        <span class="dot" data-dot="4"></span>
        <span class="dot" data-dot="5"></span>
      </div>

      <div class="onboarding-buttons">
        <button class="btn onboarding-skip" id="skipOnboarding">Bỏ qua</button>
        <button class="btn onboarding-next" id="nextOnboarding">Tiếp theo</button>
      </div>
    </div>
  </div>

  <script>
    // Force Service Worker update
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').then(reg => {
        reg.update();
      });
    }
  </script>
  <script src="app.js"></script>
</body>

</html>